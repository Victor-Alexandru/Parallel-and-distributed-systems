https://www.cs.princeton.edu/courses/archive/fall13/cos326/lec/23-parallel-scan.pdf